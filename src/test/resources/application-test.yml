spring:
  application:
    name: starscaperapidphotoupload
  
  # Database will be configured dynamically via Testcontainers
  jpa:
    hibernate:
      ddl-auto: validate
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: false
    show-sql: false
  
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true

  cloud:
    aws:
      region:
        static: us-east-1  # LocalStack default region
      credentials:
        access-key: test
        secret-key: test
      sqs:
        enabled: true
        listener:
          max-concurrent-messages: 10
          max-messages-per-poll: 10
          poll-timeout: 2  # Shorter timeout for tests to prevent hanging
          shutdown-timeout: 2s  # Shutdown timeout for graceful cleanup

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: when-authorized

# AWS configuration will be overridden by Testcontainers dynamic properties
aws:
  region: us-east-1
  s3:
    bucket: test-bucket
    presign-duration-minutes: 15
  sqs:
    queue-url: http://localhost:4566/000000000000/test-queue
    dlq-url: http://localhost:4566/000000000000/test-queue-dlq

app:
  security:
    jwt:
      secret: ${JWT_SECRET:tCGKaLd0CdhELNR0Od8sY4jvm09/z5U8qY5wbI1dzZs=}
      expiration-ms: 86400000  # 24 hours
      issuer: starscape-rapidphotoupload-api
  processing:
    thumbnail-sizes:
      - 256
      - 1024
    max-image-dimension: 8192
    supported-formats:
      - image/jpeg
      - image/png
      - image/gif
      - image/webp

