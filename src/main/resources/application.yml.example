spring:
  application:
    name: starscaperapidphotoupload
  
  datasource:
    url: jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:rapidupload}
    username: ${DB_USER:postgres}
    password: ${DB_PASSWORD:postgres}
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
  
  jpa:
    hibernate:
      ddl-auto: validate
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
        jdbc:
          batch_size: 20
    show-sql: false
  
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true
  
  cloud:
    aws:
      region:
        static: ${AWS_REGION:us-east-2}
      credentials:
        profile:
          name: ${AWS_PROFILE:}
      sqs:
        enabled: true
        listener:
          max-concurrent-messages: 10
          max-messages-per-poll: 10
          poll-timeout: 20

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: when-authorized

aws:
  region: ${AWS_REGION:us-east-2}
  profile: ${AWS_PROFILE:}  # Optional: specify AWS profile (e.g., "gauntlet") from ~/.aws/credentials
  s3:
    bucket: ${S3_BUCKET:starscape-rapidphotoupload}
    presign-duration-minutes: 15
  sqs:
    queue-url: ${SQS_QUEUE_URL:https://sqs.us-east-1.amazonaws.com/123456789/rapidupload-photo-processing-dev}
    dlq-url: ${SQS_DLQ_URL:}

app:
  security:
    jwt:
      secret: ${JWT_SECRET:change-this-in-production}
      expiration-ms: 86400000  # 24 hours
      issuer: starscape-rapidphotoupload-api
  processing:
    thumbnail-sizes:
      - 256
      - 1024
    supported-formats:
      - image/jpeg
      - image/png
      - image/gif
      - image/webp
  websocket:
    # Allowed origins for WebSocket connections (CORS).
    # Can be configured in multiple ways:
    # 1. Comma-separated string: "http://localhost:3000,https://example.com"
    # 2. Single value: "*" (allows all origins - default, use with caution in production)
    # 3. Environment variable: Set WEBSOCKET_ALLOWED_ORIGINS="http://localhost:3000,https://example.com"
    # 
    # Examples:
    #   allowed-origins: "*"  # Allow all origins (development only)
    #   allowed-origins: "http://localhost:3000,http://localhost:3001"  # Specific origins
    #   allowed-origins: ${WEBSOCKET_ALLOWED_ORIGINS:*}  # From environment variable with "*" default
    allowed-origins: ${WEBSOCKET_ALLOWED_ORIGINS:*}

